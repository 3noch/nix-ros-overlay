From e47cc42c6531cbd73831d0a58420fdd67f22fca9 Mon Sep 17 00:00:00 2001
From: Ben Wolsieffer <benwolsieffer@gmail.com>
Date: Wed, 3 Apr 2019 23:25:58 -0400
Subject: [PATCH] Make OpenNI dep sane

---
 CMakeLists.txt | 15 ++-------------
 1 file changed, 2 insertions(+), 13 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index c15e5db..9d674e3 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -33,19 +33,8 @@ else()
 set(obfilter "Off")
 endif()
 
-include(ExternalProject)
-
-ExternalProject_Add(astra_openni2
-  PREFIX astra_openni2
-  # SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/astra_openni2/OpenNI2
-  GIT_REPOSITORY https://github.com/orbbec/OpenNI2.git
-  GIT_TAG orbbec_ros
-  CONFIGURE_COMMAND echo "no need to configure"
-  BUILD_IN_SOURCE 1
-  BUILD_COMMAND make release FILTER=${obfilter}
-  INSTALL_DIR openni2
-  INSTALL_COMMAND tar -xjf <SOURCE_DIR>/Packaging/Final/OpenNI-Linux-2.3.tar.bz2 -C <INSTALL_DIR> --strip 1 && mkdir -p <INSTALL_DIR>/include && ln -fs <INSTALL_DIR>/Include <INSTALL_DIR>/include/openni2
-)
+find_package(PkgConfig)
+pkg_check_modules(astra_openni2 REQUIRED libopenni)
 
 generate_dynamic_reconfigure_options(cfg/Astra.cfg)
 add_service_files(FILES
-- 
2.21.0

